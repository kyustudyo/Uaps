# ì¸ìˆ˜ì¸ê³„ ë¬¸ì„œ (2025-10-10)

## ğŸ“Œ ì„¸ì…˜ ìš”ì•½

ì´ë²ˆ ì„¸ì…˜ì—ì„œëŠ” **ThreePartRobotBuilder ìë™í™” íˆ´**ê³¼ ê´€ë ¨ ë¬¸ì„œí™” ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. MarineThreeRobot í”„ë¦¬íŒ¹ ìˆ˜ì • (ì„ íƒ/ë“œë˜ê·¸ ë¬¸ì œ í•´ê²°)

**ë¬¸ì œ:**
- MarineThreeRobotì´ ì„ íƒë˜ì§€ ì•Šê³  ë“œë˜ê·¸ë„ ì•ˆë¨
- DecalProjector Materialì´ null
- Layerê°€ 0 (Default)
- í•„ìˆ˜ í•„ë“œë“¤ì´ ëˆ„ë½ë¨ (decalProjector, UnitSO, AvailableCommands)

**í•´ê²°:**
- âœ… Layer: 0 â†’ 6 (Selectable Units)
- âœ… DecalProjector GameObject ì¶”ê°€ (Transform + DecalProjector ì»´í¬ë„ŒíŠ¸)
- âœ… decalProjector í•„ë“œ ì°¸ì¡° ì—°ê²°
- âœ… UnitSO: Worker SO ì°¸ì¡° ì¶”ê°€ (GUID: `f15d9d4a0e8b3d848a49aaba59177157`)
- âœ… AvailableCommands: Move Action ì¶”ê°€ (GUID: `5b88f1c2df63cea41a0b8cd466334886`)
- âœ… DecalProjector Material ì„¤ì • (Selected Ring Decal Material, GUID: `949870381fdaf4941aedc8857fe165e9`)

**íŒŒì¼:** `Assets/Units/Worker/MarineThreeRobot.prefab`

---

### 2. ThreePartRobotBuilder ì—…ë°ì´íŠ¸ (ì™„ì „í•œ í”„ë¦¬íŒ¹ ìë™ ìƒì„±)

**ì—…ë°ì´íŠ¸ ë‚´ìš©:**
```csharp
// ìë™ ì„¤ì • í•­ëª©
robot.layer = 6; // Selectable Units

// DecalProjector GameObject ìë™ ìƒì„±
GameObject decalProjector = new GameObject("Decal Projector");
decalProjector.SetActive(false);
var projector = decalProjector.AddComponent<DecalProjector>();
projector.material = LoadMaterial("Selected Ring Decal Material");
projector.size = new Vector3(1.5f, 1.5f, 8f);

// SerializedObjectë¡œ ëª¨ë“  í•„ë“œ ìë™ í• ë‹¹
- headPart, bodyPart, legsPart
- decalProjector (DecalProjector ì»´í¬ë„ŒíŠ¸ ì°¸ì¡°)
- UnitSO (Ground: Worker SO, Air: Air Transport SO)
- AvailableCommands (Move Action)
```

**íŒŒì¼:** `Assets/Editor/ThreePartRobotBuilder.cs`

**ê¸°ëŠ¥:**
- Tools > Build Three-Part Robot ë©”ë‰´
- ì†ŒìŠ¤ í´ë” (`/Users/hankyulee/Desktop/ë¡œë´‡ë¶€í’ˆ/3d/{prefix}_top/center/leg/`)ì—ì„œ ìë™ ë³µì‚¬
- Material ìƒì„± ë° í…ìŠ¤ì²˜ ì ìš© (diffuse, normal, metallic)
- ì™„ì „í•œ í”„ë¦¬íŒ¹ ìƒì„± (ëª¨ë“  í•„ë“œ ìë™ í• ë‹¹)
- Sceneì— ìë™ ìŠ¤í°

---

### 3. Rule 8: THREE_PART_ROBOT_BUILDER_RULE ì¶”ê°€

**ë¬¸ì„œ ìœ„ì¹˜:**
- `.claude/RULE_8_THREE_PART_ROBOT_BUILDER.md` (ìƒì„¸ ë¬¸ì„œ)
- `.claude/code-rules.md` (Rule 8 ìš”ì•½)
- `.claude/rules-summary.md` (ë¹ ë¥¸ ì°¸ì¡°)

**í•µì‹¬ ë‚´ìš©:**
- Unity Editor ìë™í™” ë„êµ¬ëŠ” ì™„ì „í•œ í”„ë¦¬íŒ¹ ìƒì„±
- SerializedObject ì‚¬ìš© (Reflection ê¸ˆì§€)
- í•„ìˆ˜ ì»´í¬ë„ŒíŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸:
  - [x] Layer 6
  - [x] NavMeshAgent, CapsuleCollider
  - [x] DecalProjector GameObject
  - [x] ëª¨ë“  SerializedField í• ë‹¹
- AbstractUnit ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸ ì›Œí¬í”Œë¡œìš°

**íŒŒì¼:**
- `.claude/RULE_8_THREE_PART_ROBOT_BUILDER.md`
- `.claude/code-rules.md` (Line 593-606)
- `.claude/rules-summary.md` (Line 138-153)

---

### 4. Rule 5 ì—…ë°ì´íŠ¸: ìë™ ë“€ì–¼ ì»¤ë°‹ ì›Œí¬í”Œë¡œìš°

**ë³€ê²½ ì‚¬í•­:**
ì‚¬ìš©ìê°€ "ì»¤ë°‹" ë˜ëŠ” "commit" ëª…ë ¹ ì‹œ:
1. ì„œë¸Œëª¨ë“ˆ ì»¤ë°‹ (`urts-course/`)
2. **ìë™ìœ¼ë¡œ** ë£¨íŠ¸ í´ë” ì»¤ë°‹ (`lecture/`) - ì„œë¸Œëª¨ë“ˆ ì°¸ì¡° ì—…ë°ì´íŠ¸
3. ì ˆëŒ€ ë¬¼ì–´ë³´ì§€ ë§ê³  ë‘˜ ë‹¤ ìë™ ì‹¤í–‰

**êµ¬í˜„ ì˜ˆì‹œ:**
```bash
# Step 1: Commit in submodule
cd /Users/hankyulee/Desktop/Uaps/lecture/urts-course
git add .
git commit -m "feat: Add feature (ê¸°ëŠ¥ ì¶”ê°€)"

# Step 2: ALWAYS commit root folder
cd /Users/hankyulee/Desktop/Uaps/lecture
git add urts-course
git commit -m "chore: Update urts-course submodule (urts-course ì„œë¸Œëª¨ë“ˆ ì—…ë°ì´íŠ¸)"
```

**íŒŒì¼:**
- `.claude/code-rules.md` (Rule 5, Line 311-346)
- `.claude/rules-summary.md` (Rule 5, Line 64-92)

---

### 5. Worker.prefab DecalProjector ê¸°ë³¸ ë¹„í™œì„±í™”

**ë³€ê²½:**
- `m_IsActive: 1` â†’ `0`
- ê²Œì„ ì‹œì‘ ì „ì— DecalProjectorê°€ ë³´ì´ì§€ ì•Šë„ë¡ ìˆ˜ì •
- ìœ ë‹› ì„ íƒ ì‹œì—ë§Œ í™œì„±í™”ë¨

**íŒŒì¼:** `Assets/Units/Worker/Worker.prefab` (Line 19)

---

## ğŸ“ ì£¼ìš” íŒŒì¼ ë³€ê²½ ë‚´ì—­

### ìƒˆë¡œ ìƒì„±ëœ íŒŒì¼
```
.claude/RULE_8_THREE_PART_ROBOT_BUILDER.md
Assets/Editor/ThreePartRobotBuilder.cs
Assets/Units/Worker/MarineThreeRobot.prefab
Assets/Models/marine_top/
Assets/Models/marine_center/
Assets/Models/marine_leg/
```

### ìˆ˜ì •ëœ íŒŒì¼
```
.claude/code-rules.md (Rule 5, Rule 8 ì¶”ê°€)
.claude/rules-summary.md (Rule 5, Rule 8 ì—…ë°ì´íŠ¸)
Assets/Units/Worker/Worker.prefab (DecalProjector ë¹„í™œì„±í™”)
Assets/Units/Worker/MarineThreeRobot.prefab (ì™„ì „í•œ ì„¤ì •)
```

---

## ğŸ”‘ ì¤‘ìš” GUID ì°¸ì¡°

### ScriptableObjects
- **Worker SO**: `f15d9d4a0e8b3d848a49aaba59177157`
- **Air Transport SO**: `f6b38bef630bb884195c6d3f702eefb9`
- **Move Action**: `5b88f1c2df63cea41a0b8cd466334886`

### Materials
- **Selected Ring Decal Material**: `949870381fdaf4941aedc8857fe165e9`

### Scripts
- **WorkerThreeRobot**: `b7a69ec278a4949f09913fd8f726e469`
- **DecalProjector**: `0777d029ed3dffa4692f417d4aba19ca`

---

## ğŸ“Š Git ì»¤ë°‹ ì´ë ¥

### ì„œë¸Œëª¨ë“ˆ (urts-course)
```
cade4a1 - feat: Add ThreePartRobotBuilder automation tool and Rule 8
a0410a1 - docs: Update Rule 5 with automatic dual commit workflow
```

### ë£¨íŠ¸ í´ë” (lecture)
```
968d7ca - chore: Update urts-course submodule
```

---

## ğŸ¯ í˜„ì¬ í”„ë¡œì íŠ¸ ìƒíƒœ

**ê°•ì˜:**
- ì´ 15ê°œ ì™„ë£Œ (11-12ì‹œê°„)
- ìµœê·¼ ê°•ì˜: Deselecting Units with Event Bus

**Tools:**
- ThreePartRobotBuilder: 3-íŒŒíŠ¸ ë¡œë´‡ ìë™ ìƒì„± íˆ´

**í˜„ì¬ ë¸Œëœì¹˜:**
- urts-course: `dev`
- lecture: `main`

**3-Part ë¡œë´‡:**
- WorkerThreeRobot.prefab âœ…
- AirTransportThreeRobot.prefab âœ…
- MarineThreeRobot.prefab âœ… (ì´ë²ˆ ì„¸ì…˜ì—ì„œ ìˆ˜ì • ì™„ë£Œ)

---

## ğŸš€ ë‹¤ìŒ ì„¸ì…˜ì—ì„œ í•  ì¼

### 1. ThreePartRobotBuilder í…ŒìŠ¤íŠ¸
ìƒˆë¡œìš´ ë¡œë´‡ íƒ€ì… (ì˜ˆ: Sniper, Tank ë“±)ì„ Tools > Build Three-Part Robotìœ¼ë¡œ ìƒì„±í•´ì„œ ëª¨ë“  í•„ë“œê°€ ì œëŒ€ë¡œ í• ë‹¹ë˜ëŠ”ì§€ í™•ì¸

### 2. ê¸°ì¡´ í”„ë¦¬íŒ¹ ê²€ì¦
- AirTransportThreeRobot.prefab
- WorkerThreeRobot.prefab

ìœ„ í”„ë¦¬íŒ¹ë“¤ë„ ëª¨ë“  í•„ë“œê°€ ì œëŒ€ë¡œ í• ë‹¹ë˜ì–´ ìˆëŠ”ì§€ ì¬í™•ì¸

### 3. AbstractUnit/AbstractCommandable ë³€ê²½ ì‹œ ëŒ€ì‘
ë§Œì•½ ìƒˆë¡œìš´ í•„ë“œê°€ ì¶”ê°€ë˜ë©´:
1. ThreePartRobotBuilder.cs ì—…ë°ì´íŠ¸
2. ê¸°ì¡´ í”„ë¦¬íŒ¹ë“¤ ìˆ˜ì •
3. Rule 8 ë¬¸ì„œ ì—…ë°ì´íŠ¸

---

## ğŸ“ ê¸°ìˆ  ë…¸íŠ¸

### SerializedObject vs Reflection

**âŒ Reflection (ì‘ë™ ì•ˆí•¨):**
```csharp
var field = scriptType.GetField("headPart", BindingFlags.NonPublic);
field?.SetValue(script, headPart);
```

**âœ… SerializedObject (Unity ì •ì‹ ë°©ë²•):**
```csharp
SerializedObject serializedScript = new SerializedObject(script);
SerializedProperty headProperty = serializedScript.FindProperty("headPart");
headProperty.objectReferenceValue = headPart;
serializedScript.ApplyModifiedProperties();
```

### Auto-Property ë„¤ì´ë°
C# auto-propertyëŠ” Unityì—ì„œ ë°±í‚¹ í•„ë“œ ì´ë¦„ì´ ë³€ê²½ë¨:
```csharp
[field: SerializeField] public ActionBase[] AvailableCommands { get; private set; }
```
â†’ SerializedProperty ì´ë¦„: `<AvailableCommands>k__BackingField`

---

## ğŸ” ë””ë²„ê¹… íŒ

### ìœ ë‹›ì´ ì„ íƒë˜ì§€ ì•Šì„ ë•Œ ì²´í¬ë¦¬ìŠ¤íŠ¸
1. Layerê°€ 6 (Selectable Units)ì¸ê°€?
2. DecalProjector GameObjectê°€ ìì‹ìœ¼ë¡œ ìˆëŠ”ê°€?
3. decalProjector í•„ë“œê°€ nullì´ ì•„ë‹Œê°€?
4. UnitSOê°€ í• ë‹¹ë˜ì–´ ìˆëŠ”ê°€?
5. AvailableCommands ë°°ì—´ì— Move Actionì´ ìˆëŠ”ê°€?

### DecalProjectorê°€ ì•ˆ ë³´ì¼ ë•Œ
1. Materialì´ nullì´ ì•„ë‹Œê°€? (`m_Material: {fileID: 2100000, guid: 949870...}`)
2. m_IsActiveê°€ 0ì¸ê°€? (ê²Œì„ ì‹œì‘ ì „ì—ëŠ” êº¼ì ¸ìˆì–´ì•¼ í•¨)
3. DecalLayerMaskê°€ 2ì¸ê°€?
4. Sizeì™€ Pivotì´ ì˜¬ë°”ë¥¸ê°€? (Size: 1.5, 1.5, 8 / Pivot: 0, 0, 4)

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **Rule 8**: `.claude/RULE_8_THREE_PART_ROBOT_BUILDER.md`
- **Rule 5**: `.claude/code-rules.md` (Line 246-351)
- **Rules Summary**: `.claude/rules-summary.md`
- **Architecture**: `/Users/hankyulee/Desktop/Uaps/lecture/urts-scripts-architecture.html`

---

## ğŸ’¡ ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸

1. **Unity Editor Scriptingì€ SerializedObject ì‚¬ìš©**
   - Reflectionì€ Unity Editorì—ì„œ ì‹ ë¢°ì„±ì´ ë‚®ìŒ
   - SerializedPropertyë¡œ í•„ë“œ í• ë‹¹ì´ ì •ì„

2. **Layer 6ì€ ìœ ë‹› ì„ íƒì˜ í•µì‹¬**
   - PlayerInputì—ì„œ Raycastí•  ë•Œ Layer 6ë§Œ ê°ì§€
   - Layer 0ì´ë©´ ì„ íƒ ë¶ˆê°€

3. **DecalProjectorëŠ” ë³„ë„ GameObject**
   - ë‹¨ìˆœ ì»´í¬ë„ŒíŠ¸ê°€ ì•„ë‹Œ ìì‹ GameObjectë¡œ ì¶”ê°€
   - Transform ì„¤ì • í•„ìˆ˜ (Rotation: 90, 0, 0)

4. **ìë™í™” ë„êµ¬ëŠ” ì™„ì „í•œ í”„ë¦¬íŒ¹ ìƒì„±**
   - ìˆ˜ë™ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ìë™í™” ì‹¤íŒ¨
   - Rule 8ì„ ë”°ë¼ ëª¨ë“  í•„ë“œ ìë™ í• ë‹¹

5. **ë“€ì–¼ ì»¤ë°‹ í•„ìˆ˜**
   - ì„œë¸Œëª¨ë“ˆë§Œ ì»¤ë°‹í•˜ë©´ ë£¨íŠ¸ í´ë”ì— ë°˜ì˜ ì•ˆë¨
   - í•­ìƒ ì„œë¸Œëª¨ë“ˆ â†’ ë£¨íŠ¸ ìˆœì„œë¡œ ì»¤ë°‹

---

**ì‘ì„±ì¼**: 2025-10-10
**ì‘ì„±ì**: Claude Code
**ë‹¤ìŒ ì„¸ì…˜ ì‹œì‘ ì‹œ**: `ì¸ìˆ˜ì¸ê³„` ëª…ë ¹ì–´ ë˜ëŠ” `/handoff` ìŠ¬ë˜ì‹œ ì»¤ë§¨ë“œ ì‹¤í–‰
