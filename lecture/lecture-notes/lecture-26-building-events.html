<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•ì˜ 26: Building Events (ë¹Œë”© ì´ë²¤íŠ¸)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section h3 {
            color: #333;
            margin: 20px 0 15px 0;
            font-size: 1.3rem;
        }

        .problem-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .solution-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .code-box {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .code-box .keyword {
            color: #c678dd;
        }

        .code-box .type {
            color: #e5c07b;
        }

        .code-box .string {
            color: #98c379;
        }

        .code-box .comment {
            color: #5c6370;
            font-style: italic;
        }

        .flow-diagram {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .step {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .step:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .step-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .step-content {
            flex: 1;
        }

        .file-list {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .file-item {
            padding: 10px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            font-size: 1.2rem;
        }

        .new-file {
            border-left: 3px solid #28a745;
        }

        .modified-file {
            border-left: 3px solid #ffc107;
        }

        .event-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        .event-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
        }

        .event-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .event-table tr:hover {
            background: #f8f9fa;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .emoji {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        ul, ol {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin: 8px 0;
        }

        strong {
            color: #667eea;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .content {
                padding: 20px;
            }

            .section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ—ï¸ ê°•ì˜ 26: Building Events</h1>
            <div class="subtitle">Behavior Treeì— ë¹Œë”© ì´ë²¤íŠ¸ ë„ì…í•˜ê¸°</div>
            <div class="subtitle" style="margin-top: 10px; font-size: 1rem;">
                Commit: <code style="background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 4px;">db23ada</code>
            </div>
        </div>

        <div class="content">
            <!-- ë¬¸ì œ ì •ì˜ -->
            <div class="section">
                <h2><span class="emoji">ğŸ›</span>ë°œê²¬ëœ ë¬¸ì œë“¤</h2>

                <div class="problem-box">
                    <h3>ë¬¸ì œ 1: ì—¬ëŸ¬ ì›Œì»¤ê°€ ë™ì‹œì— ê±´ë¬¼ì„ ì§€ì„ ë•Œ</h3>
                    <ul>
                        <li>ì›Œì»¤ Aê°€ ê±´ë¬¼ì„ ì§“ë‹¤ê°€ ì£½ìœ¼ë©´</li>
                        <li>ì›Œì»¤ Bì™€ Cë¥¼ ëª¨ë‘ ê·¸ ê±´ë¬¼ë¡œ ë³´ë‚´ë©´</li>
                        <li>ë‘˜ ë‹¤ <span class="highlight">Cancel Building</span> ë²„íŠ¼ì´ ë‚˜íƒ€ë‚¨</li>
                        <li>í•œ ì›Œì»¤ê°€ ì·¨ì†Œí•˜ë©´ ë‹¤ë¥¸ ì›Œì»¤ëŠ” ì—¬ì „íˆ "ì§“ê³  ìˆëŠ”" ìƒíƒœë¡œ ë³´ì„</li>
                    </ul>
                </div>

                <div class="problem-box">
                    <h3>ë¬¸ì œ 2: ê±´ë¬¼ì— ë„ì°©í•˜ê¸° ì „ ì»¤ë§¨ë“œ í‘œì‹œ</h3>
                    <ul>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ë¡œ <strong>ì´ë™ ì¤‘</strong>ì¼ ë•Œë„ Cancel Building ë²„íŠ¼ì´ ë³´ì„</li>
                        <li>ì•„ì§ ê±´ë¬¼ì— ë„ì°©í•˜ì§€ë„ ì•Šì•˜ëŠ”ë° ì·¨ì†Œê°€ ê°€ëŠ¥í•¨</li>
                        <li>Right-clickìœ¼ë¡œ ëª…ë ¹ì„ ì·¨ì†Œí•  ìˆ˜ ì—†ì–´ì•¼ í•˜ëŠ”ë° ê°€ëŠ¥í•¨</li>
                    </ul>
                </div>

                <div class="problem-box">
                    <h3>ë¬¸ì œ 3: ì—¬ëŸ¬ ì›Œì»¤ê°€ Resume Building í•  ë•Œ</h3>
                    <ul>
                        <li>ì²« ë²ˆì§¸ ì›Œì»¤ë§Œ ì‹¤ì œë¡œ ê±´ë¬¼ì„ ì§€ì–´ì•¼ í•¨</li>
                        <li>ë‚˜ë¨¸ì§€ ì›Œì»¤ë“¤ì€ ë‹¨ìˆœíˆ <strong>Move ëª…ë ¹</strong>ìœ¼ë¡œ ì²˜ë¦¬ë˜ì–´ì•¼ í•¨</li>
                        <li>í•˜ì§€ë§Œ í˜„ì¬ëŠ” ëª¨ë“  ì›Œì»¤ê°€ ê±´ë¬¼ì„ ì§“ëŠ” ê²ƒì²˜ëŸ¼ ë™ì‘í•¨</li>
                    </ul>
                </div>
            </div>

            <!-- í•´ê²°ì±… -->
            <div class="section">
                <h2><span class="emoji">ğŸ’¡</span>í•´ê²°ì±…: Building Events</h2>

                <div class="solution-box">
                    <h3>í•µì‹¬ ì•„ì´ë””ì–´</h3>
                    <p><strong>Behavior Treeì—ì„œ ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œì¼œ</strong> Workerê°€ ê±´ë¬¼ ì§“ê¸° ìƒíƒœë¥¼ ì •í™•íˆ ê´€ë¦¬í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
                    <ul>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ ìœ„ì¹˜ì— <strong>ë„ì°©í–ˆì„ ë•Œ</strong> â†’ ArrivedAt ì´ë²¤íŠ¸</li>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ ì§“ê¸°ë¥¼ <strong>ì‹œì‘í–ˆì„ ë•Œ</strong> â†’ BeginBuilding ì´ë²¤íŠ¸</li>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ ì§“ê¸°ë¥¼ <strong>ì™„ë£Œí–ˆì„ ë•Œ</strong> â†’ CompletedBuilding ì´ë²¤íŠ¸</li>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ ì§“ê¸°ë¥¼ <strong>ì¤‘ë‹¨í•´ì•¼ í•  ë•Œ</strong> â†’ Abort ì´ë²¤íŠ¸</li>
                        <li>ì›Œì»¤ê°€ ê±´ë¬¼ ì§“ê¸°ë¥¼ <strong>ì·¨ì†Œí–ˆì„ ë•Œ</strong> â†’ Cancel ì´ë²¤íŠ¸</li>
                    </ul>
                </div>

                <div class="flow-diagram">
                    <h3 style="text-align: center; margin-bottom: 20px;">ğŸ”„ Building Event íë¦„</h3>

                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <strong>ì›Œì»¤ê°€ ê±´ë¬¼ ìœ„ì¹˜ì— ë„ì°©</strong><br>
                            â†’ <code>ArrivedAt</code> ì´ë²¤íŠ¸ ë°œìƒ
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <strong>ê±´ë¬¼ì´ ì´ë¯¸ ê±´ì„¤ ì¤‘ì¸ì§€ í™•ì¸</strong><br>
                            â†’ ê±´ì„¤ ì¤‘ì´ë©´ <code>Abort</code> ì´ë²¤íŠ¸ (ë‹¤ë¥¸ ì›Œì»¤ê°€ ì´ë¯¸ ì§“ê³  ìˆìŒ)<br>
                            â†’ ê±´ì„¤ ì¤‘ì´ ì•„ë‹ˆë©´ ê³„ì† ì§„í–‰
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <strong>ê±´ë¬¼ ì§“ê¸° ì‹œì‘</strong><br>
                            â†’ <code>BeginBuilding</code> ì´ë²¤íŠ¸ ë°œìƒ<br>
                            â†’ Cancel Building ì»¤ë§¨ë“œ í‘œì‹œ
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <strong>NavMesh ê°€ì¥ìë¦¬ë¡œ ì´ë™</strong><br>
                            â†’ ê±´ë¬¼ì„ ì§“ëŠ” ë™ì•ˆ...
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <strong>ê±´ë¬¼ ì§“ê¸° ì™„ë£Œ</strong><br>
                            â†’ <code>CompletedBuilding</code> ì´ë²¤íŠ¸ ë°œìƒ<br>
                            â†’ ì»¤ë§¨ë“œ ì´ˆê¸°í™”
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìƒˆë¡œ ì¶”ê°€ëœ íŒŒì¼ë“¤ -->
            <div class="section">
                <h2><span class="emoji">ğŸ“„</span>ìƒˆë¡œ ì¶”ê°€ëœ íŒŒì¼ë“¤</h2>

                <div class="file-list">
                    <div class="file-item new-file">
                        <span class="file-icon">ğŸ†•</span>
                        <div>
                            <strong>BuildingEventType.cs</strong><br>
                            <small>ë¹Œë”© ì´ë²¤íŠ¸ ì¢…ë¥˜ë¥¼ ì •ì˜í•˜ëŠ” Enum</small>
                        </div>
                    </div>

                    <div class="file-item new-file">
                        <span class="file-icon">ğŸ†•</span>
                        <div>
                            <strong>BuildingEventChannel.cs</strong><br>
                            <small>ë¹Œë”© ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬í•˜ëŠ” ì´ë²¤íŠ¸ ì±„ë„</small>
                        </div>
                    </div>

                    <div class="file-item new-file">
                        <span class="file-icon">ğŸ†•</span>
                        <div>
                            <strong>BuildingIsInProgressCondition.cs</strong><br>
                            <small>ê±´ë¬¼ì´ í˜„ì¬ ê±´ì„¤ ì¤‘ì¸ì§€ í™•ì¸í•˜ëŠ” ì»¤ìŠ¤í…€ ì¡°ê±´</small>
                        </div>
                    </div>
                </div>

                <h3>1ï¸âƒ£ BuildingEventType.cs</h3>
                <div class="code-box">
<span class="keyword">using</span> UnityEngine.Behavior;

<span class="keyword">namespace</span> <span class="type">GameDevTV.RTS.Units</span>
{
    [<span class="type">BlackboardEnum</span>]  <span class="comment">// Behavior Treeì—ì„œ ì‚¬ìš© ê°€ëŠ¥</span>
    <span class="keyword">public enum</span> <span class="type">BuildingEventType</span>
    {
        <span class="type">ArrivedAt</span>,         <span class="comment">// ì›Œì»¤ê°€ ê±´ë¬¼ ìœ„ì¹˜ì— ë„ì°©</span>
        <span class="type">BeginBuilding</span>,     <span class="comment">// ì›Œì»¤ê°€ ê±´ë¬¼ ì§“ê¸° ì‹œì‘</span>
        <span class="type">CompletedBuilding</span>, <span class="comment">// ê±´ë¬¼ ì§“ê¸° ì™„ë£Œ</span>
        <span class="type">Cancel</span>,            <span class="comment">// ê±´ë¬¼ ì§“ê¸° ì·¨ì†Œ (í™˜ë¶ˆ)</span>
        <span class="type">Abort</span>              <span class="comment">// ê±´ë¬¼ ì§“ê¸° ì¤‘ë‹¨ (ë‹¤ë¥¸ ì›Œì»¤ê°€ ì´ë¯¸ ê±´ì„¤ ì¤‘)</span>
    }
}
                </div>

                <h3>2ï¸âƒ£ BuildingEventChannel.cs</h3>
                <div class="code-box">
<span class="comment">// Unity Behaviorì—ì„œ ìë™ ìƒì„±ë¨</span>
<span class="comment">// Blackboard â†’ Events â†’ Create Event Channel Type</span>
<span class="comment">// ì´ë²¤íŠ¸ ì´ë¦„: "self building event type on base building"</span>

<span class="keyword">using</span> GameDevTV.RTS.Units;

<span class="keyword">public class</span> <span class="type">BuildingEventChannel</span>
{
    <span class="comment">// GameObject self</span>
    <span class="comment">// BuildingEventType eventType</span>
    <span class="comment">// BaseBuilding building</span>
}
                </div>

                <h3>3ï¸âƒ£ BuildingIsInProgressCondition.cs</h3>
                <div class="code-box">
<span class="keyword">using</span> UnityEngine.Behavior;
<span class="keyword">using</span> GameDevTV.RTS.Units;

<span class="keyword">namespace</span> <span class="type">GameDevTV.RTS.Behavior</span>
{
    <span class="keyword">public class</span> <span class="type">BuildingIsInProgressCondition</span> : <span class="type">Condition</span>
    {
        <span class="keyword">public</span> <span class="type">BlackboardVariable&lt;BaseBuilding&gt;</span> baseBuildingValue;

        <span class="keyword">public override bool</span> <span class="type">IsTrue</span>()
        {
            <span class="comment">// ê±´ë¬¼ì´ ì¡´ì¬í•˜ê³  && ê±´ë¬¼ì´ Building ìƒíƒœë©´ true</span>
            <span class="keyword">return</span> baseBuildingValue.Value != <span class="keyword">null</span> &&
                   baseBuildingValue.Value.ProgressState == <span class="type">BuildingProgressState.Building</span>;
        }
    }
}
                </div>
            </div>

            <!-- Event Type ì„¤ëª… -->
            <div class="section">
                <h2><span class="emoji">ğŸ¯</span>Event Type ìƒì„¸ ì„¤ëª…</h2>

                <table class="event-table">
                    <thead>
                        <tr>
                            <th>Event Type</th>
                            <th>ë°œìƒ ì‹œì </th>
                            <th>ë™ì‘</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ArrivedAt</strong></td>
                            <td>ì›Œì»¤ê°€ ê±´ë¬¼ ìœ„ì¹˜ì— ë„ì°©í–ˆì„ ë•Œ</td>
                            <td>
                                â€¢ ê±´ë¬¼ì´ ì´ë¯¸ ê±´ì„¤ ì¤‘ì´ë©´ ì¤‘ë‹¨ (Abort)<br>
                                â€¢ ê±´ë¬¼ì´ ê±´ì„¤ ì¤‘ì´ ì•„ë‹ˆë©´ Cancel ë²„íŠ¼ í‘œì‹œ
                            </td>
                        </tr>
                        <tr>
                            <td><strong>BeginBuilding</strong></td>
                            <td>ì›Œì»¤ê°€ ì‹¤ì œë¡œ ê±´ë¬¼ ì§“ê¸°ë¥¼ ì‹œì‘í•  ë•Œ</td>
                            <td>
                                â€¢ Cancel Building ì»¤ë§¨ë“œ í™•ì‹¤íˆ í‘œì‹œ<br>
                                â€¢ ì•ˆì „ ì¥ì¹˜ë¡œ í•œ ë²ˆ ë” ì„¤ì •
                            </td>
                        </tr>
                        <tr>
                            <td><strong>CompletedBuilding</strong></td>
                            <td>ê±´ë¬¼ ì§“ê¸°ê°€ ì™„ë£Œë˜ì—ˆì„ ë•Œ</td>
                            <td>
                                â€¢ ë³„ë„ ì²˜ë¦¬ ì—†ìŒ (ì´ë¯¸ ë‹¤ë¥¸ ê³³ì—ì„œ ì²˜ë¦¬ë¨)
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Cancel</strong></td>
                            <td>í”Œë ˆì´ì–´ê°€ ê±´ë¬¼ ì§“ê¸°ë¥¼ ì·¨ì†Œí–ˆì„ ë•Œ</td>
                            <td>
                                â€¢ ì»¤ë§¨ë“œ ì˜¤ë²„ë¼ì´ë“œë¥¼ nullë¡œ ì„¤ì •<br>
                                â€¢ Cancel ë²„íŠ¼ ì œê±°
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Abort</strong></td>
                            <td>ë‹¤ë¥¸ ì›Œì»¤ê°€ ì´ë¯¸ ê±´ë¬¼ì„ ì§“ê³  ìˆì„ ë•Œ</td>
                            <td>
                                â€¢ ì»¤ë§¨ë“œ ì˜¤ë²„ë¼ì´ë“œë¥¼ nullë¡œ ì„¤ì •<br>
                                â€¢ ì›Œì»¤ëŠ” ê·¸ëƒ¥ ë©ˆì¶¤ (Stop)
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Worker.cs ë³€ê²½ ì‚¬í•­ -->
            <div class="section">
                <h2><span class="emoji">ğŸ”§</span>Worker.cs ë³€ê²½ ì‚¬í•­</h2>

                <h3>Building Event ë¦¬ìŠ¤ë‹ ì¶”ê°€</h3>
                <div class="code-box">
<span class="comment">// OnStart()ì—ì„œ ì´ë²¤íŠ¸ ì±„ë„ êµ¬ë…</span>
<span class="keyword">var</span> buildingEventChannelVariable = graphAgent.GetVariable<<span class="type">BuildingEventChannel</span>>(<span class="string">"BuildingEventChannel"</span>);
buildingEventChannelVariable.Value.Event += HandleBuildingEvent;
                </div>

                <h3>Building Event í•¸ë“¤ëŸ¬</h3>
                <div class="code-box">
<span class="keyword">private void</span> <span class="type">HandleBuildingEvent</span>(<span class="type">GameObject</span> self, <span class="type">BuildingEventType</span> eventType, <span class="type">BaseBuilding</span> building)
{
    <span class="keyword">switch</span> (eventType)
    {
        <span class="keyword">case</span> <span class="type">BuildingEventType.ArrivedAt</span>:
            <span class="comment">// ê±´ë¬¼ì´ ì´ë¯¸ ê±´ì„¤ ì¤‘ì´ë©´ ê·¸ëƒ¥ ë©ˆì¶¤</span>
            <span class="keyword">if</span> (building != <span class="keyword">null</span> && building.ProgressState == <span class="type">BuildingProgressState.Building</span>)
            {
                Stop();
            }
            <span class="keyword">else</span>
            {
                <span class="comment">// ê±´ë¬¼ì´ ê±´ì„¤ ì¤‘ì´ ì•„ë‹ˆë©´ Cancel ë²„íŠ¼ í‘œì‹œ</span>
                SetCommandOverrides(cancelBuildingCommand);
            }
            <span class="keyword">break</span>;

        <span class="keyword">case</span> <span class="type">BuildingEventType.BeginBuilding</span>:
            <span class="comment">// ì•ˆì „ ì¥ì¹˜ë¡œ í•œ ë²ˆ ë” ì„¤ì •</span>
            SetCommandOverrides(cancelBuildingCommand);
            <span class="keyword">break</span>;

        <span class="keyword">case</span> <span class="type">BuildingEventType.Cancel</span>:
        <span class="keyword">case</span> <span class="type">BuildingEventType.Abort</span>:
            <span class="comment">// ì»¤ë§¨ë“œ ì´ˆê¸°í™”</span>
            SetCommandOverrides(<span class="keyword">null</span>);
            <span class="keyword">break</span>;

        <span class="keyword">case</span> <span class="type">BuildingEventType.CompletedBuilding</span>:
            <span class="comment">// ë³„ë„ ì²˜ë¦¬ ì—†ìŒ</span>
            <span class="keyword">break</span>;
    }
}
                </div>

                <h3>BuildBuilding / ResumeBuilding ìˆ˜ì •</h3>
                <div class="code-box">
<span class="keyword">public void</span> <span class="type">BuildBuilding</span>(<span class="type">BaseBuilding</span> building, <span class="type">Vector3</span> target)
{
    <span class="comment">// ìƒˆ ê±´ë¬¼ ì§“ê¸° ì‹œì‘í•  ë•ŒëŠ” ì¦‰ì‹œ Cancel ë²„íŠ¼ í‘œì‹œ (OK)</span>
    SetCommandOverrides(cancelBuildingCommand);
}

<span class="keyword">public void</span> <span class="type">ResumeBuilding</span>(<span class="type">BaseBuilding</span> building, <span class="type">Vector3</span> target)
{
    <span class="comment">// âŒ ì œê±°: SetCommandOverrides(cancelBuildingCommand)</span>
    <span class="comment">// ì´ì œ ArrivedAt ì´ë²¤íŠ¸ì—ì„œë§Œ Cancel ë²„íŠ¼ í‘œì‹œ</span>
    <span class="comment">// ì›Œì»¤ê°€ ê±´ë¬¼ì— ë„ì°©í•˜ê¸° ì „ê¹Œì§€ëŠ” Right-clickìœ¼ë¡œ ì·¨ì†Œ ê°€ëŠ¥</span>
}
                </div>
            </div>

            <!-- ISelectable ë³€ê²½ -->
            <div class="section">
                <h2><span class="emoji">âœ…</span>ISelectable / AbstractCommandable ë³€ê²½</h2>

                <div class="problem-box">
                    <h3>ì´ì „ ë¬¸ì œ</h3>
                    <p><code>SetCommandOverrides()</code>ë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ <code>UnitSelectedEvent</code>ë¥¼ ë°œìƒì‹œì¼°ìŠµë‹ˆë‹¤.</p>
                    <p>í•˜ì§€ë§Œ ìœ ë‹›ì´ ì‹¤ì œë¡œ ì„ íƒë˜ì§€ ì•Šì•˜ëŠ”ë°ë„ ì´ë²¤íŠ¸ê°€ ë°œìƒí•´ì„œ UIê°€ ì˜ëª» ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                </div>

                <div class="solution-box">
                    <h3>í•´ê²°ì±…</h3>
                    <p><code>IsSelected</code> ì†ì„±ì„ ì¶”ê°€í•˜ê³ , <strong>ìœ ë‹›ì´ ì„ íƒë˜ì—ˆì„ ë•Œë§Œ</strong> ì´ë²¤íŠ¸ë¥¼ ë°œìƒì‹œí‚µë‹ˆë‹¤.</p>
                </div>

                <h3>ISelectable ì¸í„°í˜ì´ìŠ¤</h3>
                <div class="code-box">
<span class="keyword">public interface</span> <span class="type">ISelectable</span>
{
    <span class="keyword">public bool</span> IsSelected { <span class="keyword">get</span>; }  <span class="comment">// ìƒˆë¡œ ì¶”ê°€</span>
    <span class="keyword">void</span> Select();
    <span class="keyword">void</span> Deselect();
}
                </div>

                <h3>AbstractCommandable êµ¬í˜„</h3>
                <div class="code-box">
<span class="keyword">public abstract class</span> <span class="type">AbstractCommandable</span> : <span class="type">MonoBehaviour</span>, <span class="type">ISelectable</span>
{
    <span class="keyword">public bool</span> IsSelected { <span class="keyword">get</span>; <span class="keyword">protected set</span>; }

    <span class="keyword">public void</span> <span class="type">Select</span>()
    {
        IsSelected = <span class="keyword">true</span>;
        <span class="comment">// ... ê¸°ì¡´ ì½”ë“œ</span>
    }

    <span class="keyword">public void</span> <span class="type">Deselect</span>()
    {
        IsSelected = <span class="keyword">false</span>;
        <span class="comment">// ... ê¸°ì¡´ ì½”ë“œ</span>
    }

    <span class="keyword">protected void</span> <span class="type">SetCommandOverrides</span>(<span class="type">ActionBase[]</span> commands)
    {
        commandOverrides = commands;

        <span class="comment">// âœ… ìœ ë‹›ì´ ì„ íƒë˜ì—ˆì„ ë•Œë§Œ ì´ë²¤íŠ¸ ë°œìƒ</span>
        <span class="keyword">if</span> (IsSelected)
        {
            Bus<<span class="type">UnitSelectedEvent</span>>.Raise(<span class="keyword">new</span> <span class="type">UnitSelectedEvent</span> { unit = <span class="keyword">this</span> });
        }
    }
}
                </div>
            </div>

            <!-- Behavior Tree ë³€ê²½ -->
            <div class="section">
                <h2><span class="emoji">ğŸŒ³</span>Worker Behavior Tree ë³€ê²½</h2>

                <h3>Build Building ì„œë¸ŒíŠ¸ë¦¬ êµ¬ì¡°</h3>
                <div class="flow-diagram">
                    <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
                        <strong>ê¸°ì¡´ ë¬¸ì œ:</strong> ì—¬ëŸ¬ ì›Œì»¤ê°€ Resumeí•  ë•Œ ëª¨ë‘ Cancel ë²„íŠ¼ì´ ë‚˜íƒ€ë‚¨
                    </div>

                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <strong>Move to Target Location</strong><br>
                            ê±´ë¬¼ ìœ„ì¹˜ë¡œ ì´ë™
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <strong>Send Event: ArrivedAt</strong><br>
                            â†’ ì›Œì»¤ê°€ ë„ì°©í–ˆìŒì„ ì•Œë¦¼<br>
                            â†’ Worker.csì—ì„œ ê±´ë¬¼ ìƒíƒœ í™•ì¸ í›„ Cancel ë²„íŠ¼ í‘œì‹œ
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <strong>Conditional Branch: Building Is In Progress?</strong><br>
                            â†’ True: Abort ì´ë²¤íŠ¸ ë°œìƒ í›„ ì¤‘ë‹¨<br>
                            â†’ False: ê³„ì† ì§„í–‰
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <strong>Send Event: BeginBuilding</strong><br>
                            â†’ ê±´ë¬¼ ì§“ê¸° ì‹œì‘ì„ ì•Œë¦¼
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <strong>Move to Closest Point on Edge of NavMesh</strong><br>
                            â†’ NavMesh ê°€ì¥ìë¦¬ë¡œ ì´ë™ (ê±´ë¬¼ ì£¼ë³€)
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">6</div>
                        <div class="step-content">
                            <strong>Send Event: CompletedBuilding</strong><br>
                            â†’ ê±´ë¬¼ ì§“ê¸° ì™„ë£Œë¥¼ ì•Œë¦¼
                        </div>
                    </div>

                    <div class="step">
                        <div class="step-number">7</div>
                        <div class="step-content">
                            <strong>Set Building Under Construction to null</strong><br>
                            â†’ ìƒíƒœ ì´ˆê¸°í™”
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë°°ìš´ ë‚´ìš© -->
            <div class="section">
                <h2><span class="emoji">ğŸ“š</span>ì´ ê°•ì˜ì—ì„œ ë°°ìš´ ë‚´ìš©</h2>

                <div class="solution-box">
                    <h3>1ï¸âƒ£ Behavior Treeì—ì„œ ì´ë²¤íŠ¸ ë°œìƒì‹œí‚¤ê¸°</h3>
                    <ul>
                        <li><strong>Send Event Message</strong> ë…¸ë“œ ì‚¬ìš©</li>
                        <li>ì´ë²¤íŠ¸ ì±„ë„ì„ í†µí•´ C# ì½”ë“œë¡œ ì´ë²¤íŠ¸ ì „ë‹¬</li>
                        <li>BTì™€ ìŠ¤í¬ë¦½íŠ¸ ê°„ í†µì‹  ë°©ë²•</li>
                    </ul>
                </div>

                <div class="solution-box">
                    <h3>2ï¸âƒ£ ì»¤ìŠ¤í…€ Condition ë§Œë“¤ê¸°</h3>
                    <ul>
                        <li><code>Condition</code> í´ë˜ìŠ¤ ìƒì†</li>
                        <li><code>IsTrue()</code> ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë“œ</li>
                        <li><strong>Conditional Branch</strong> ë…¸ë“œì—ì„œ ì‚¬ìš©</li>
                        <li>ë³µì¡í•œ ì¡°ê±´ ë¡œì§ì„ BTì— ì¶”ê°€ ê°€ëŠ¥</li>
                    </ul>
                </div>

                <div class="solution-box">
                    <h3>3ï¸âƒ£ ì´ë²¤íŠ¸ ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬</h3>
                    <ul>
                        <li>ì—¬ëŸ¬ ì›Œì»¤ê°€ ê°™ì€ ê±´ë¬¼ì„ ë™ì‹œì— ì§€ìœ¼ë ¤ í•  ë•Œ ì¶©ëŒ ë°©ì§€</li>
                        <li>ì •í™•í•œ íƒ€ì´ë°ì— UI ì—…ë°ì´íŠ¸ (Cancel ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€)</li>
                        <li><code>IsSelected</code> ì²´í¬ë¡œ ë¶ˆí•„ìš”í•œ ì´ë²¤íŠ¸ ë°œìƒ ë°©ì§€</li>
                    </ul>
                </div>
            </div>

            <!-- ìš”ì•½ -->
            <div class="section">
                <h2><span class="emoji">ğŸ¯</span>í•µì‹¬ ìš”ì•½</h2>

                <div style="background: white; padding: 25px; border-radius: 12px; border: 3px solid #667eea;">
                    <h3 style="color: #667eea; margin-top: 0;">í•´ê²°ëœ ë¬¸ì œë“¤</h3>
                    <ul style="font-size: 1.1rem;">
                        <li>âœ… ì—¬ëŸ¬ ì›Œì»¤ê°€ ë™ì‹œì— ê±´ë¬¼ì„ ì§€ì„ ë•Œ <strong>ì²« ë²ˆì§¸ ì›Œì»¤ë§Œ</strong> ê±´ë¬¼ì„ ì§“ê³  ë‚˜ë¨¸ì§€ëŠ” ì¤‘ë‹¨</li>
                        <li>âœ… ì›Œì»¤ê°€ ê±´ë¬¼ì— <strong>ë„ì°©í•œ í›„ì—ë§Œ</strong> Cancel ë²„íŠ¼ í‘œì‹œ</li>
                        <li>âœ… Cancel/Abort ì‹œ ì»¤ë§¨ë“œ UIê°€ <strong>ì •í™•íˆ</strong> ì—…ë°ì´íŠ¸ë¨</li>
                        <li>âœ… Resume Building ì‹œ Right-clickìœ¼ë¡œ <strong>ì¤‘ë„ ì·¨ì†Œ ê°€ëŠ¥</strong></li>
                    </ul>

                    <h3 style="color: #667eea; margin-top: 25px;">ìƒˆë¡œ ì¶”ê°€ëœ ê¸°ëŠ¥</h3>
                    <ul style="font-size: 1.1rem;">
                        <li>ğŸ“¢ <strong>BuildingEventType</strong> - 5ê°€ì§€ ì´ë²¤íŠ¸ íƒ€ì…</li>
                        <li>ğŸ“¡ <strong>BuildingEventChannel</strong> - BT â†’ C# ì´ë²¤íŠ¸ ì „ë‹¬</li>
                        <li>ğŸ” <strong>BuildingIsInProgressCondition</strong> - ì»¤ìŠ¤í…€ ì¡°ê±´</li>
                        <li>âœ… <strong>IsSelected</strong> - ì„ íƒ ìƒíƒœ í™•ì¸</li>
                    </ul>
                </div>
            </div>

            <!-- ë§ˆë¬´ë¦¬ -->
            <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                <h2 style="color: white;">ğŸ‰ ì™„ë£Œ!</h2>
                <p style="font-size: 1.2rem; line-height: 1.8;">
                    ì´ì œ ì—¬ëŸ¬ ì›Œì»¤ê°€ ê±´ë¬¼ì„ ì§€ì„ ë•Œ ë°œìƒí•˜ë˜ ëª¨ë“  ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
                    <strong>ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜</strong>ë¡œ ë” ì•ˆì •ì ì´ê³  ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë™ì‘ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
                </p>
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ë” ë§ì€ Unity Behavior ê¸°ëŠ¥ì„ í™œìš©í•´ë³´ì„¸ìš”!
                </div>
            </div>
        </div>
    </div>
</body>
</html>
